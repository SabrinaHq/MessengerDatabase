DROP TABLE MESSAGE;
DROP TABLE CONVERSATION;
DROP TABLE USER_GROUP;
DROP TABLE USERS;
DROP TABLE ADMIN;


CREATE TABLE USERS(
	USER_ID NUMBER(10) NOT NULL,
	USER_NAME VARCHAR(100) NOT NULL,
	PASSWORD VARCHAR(100) NOT NULL,
	EMAIL VARCHAR(150) NOT NULL,
	FIRST_NAME VARCHAR(100),
	LAST_NAME VARCHAR(100),
	COUNTRY VARCHAR(20),
	AGE NUMBER(10) CHECK(AGE>14),
	CHAT_MODE VARCHAR(10)
	);

ALTER TABLE USERS ADD CONSTRAINT USER_PK
	PRIMARY KEY(USER_ID);

CREATE TABLE USER_GROUP(
	GROUP_ID NUMBER(10),
	GROUP_NAME VARCHAR(15),
	USER_ID NUMBER(10),
	CREATE_DATE DATE,
	STATUS VARCHAR(10)
	);

ALTER TABLE USER_GROUP ADD
	PRIMARY KEY(GROUP_ID);

ALTER TABLE USER_GROUP ADD
	FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID) ON DELETE CASCADE;


CREATE TABLE CONVERSATION(
	CONV_ID NUMBER(10),
	USER_ONE NUMBER(10),
	USER_TWO NUMBER(10),
	USER_GROUP NUMBER(10)
	);

ALTER TABLE CONVERSATION ADD
	PRIMARY KEY(CONV_ID);
ALTER TABLE CONVERSATION ADD
	FOREIGN KEY (USER_ONE) REFERENCES USERS (USER_ID) ON DELETE CASCADE;
ALTER TABLE CONVERSATION ADD
	FOREIGN KEY (USER_TWO) REFERENCES USERS (USER_ID) ON DELETE CASCADE;
ALTER TABLE CONVERSATION ADD
	FOREIGN KEY (USER_GROUP) REFERENCES USER_GROUP (GROUP_ID) ON DELETE CASCADE;	


CREATE TABLE MESSAGE(
	MESSAGE_ID NUMBER(10),
	SENDER_ID NUMBER(10),
	RECEIVER_ID NUMBER(10),
	RECEIVER_GROUP_ID NUMBER(10),
	MESSAGE_CONTENT VARCHAR(500),
	MESSAGE_CREATION_DATE DATE
	 );

ALTER TABLE MESSAGE ADD
	PRIMARY KEY(MESSAGE_ID);
ALTER TABLE MESSAGE ADD
	FOREIGN KEY (SENDER_ID) REFERENCES USERS (USER_ID) ON DELETE CASCADE;
ALTER TABLE MESSAGE ADD
	FOREIGN KEY (RECEIVER_ID) REFERENCES USERS (USER_ID) ON DELETE CASCADE;
ALTER TABLE MESSAGE ADD
	FOREIGN KEY (RECEIVER_GROUP_ID) REFERENCES USER_GROUP (GROUP_ID) ON DELETE CASCADE;
	





CREATE TABLE ADMIN(
NAME VARCHAR(100) NOT NULL,
EMAIL VARCHAR(100) NOT NULL,
PASSWORD VARCHAR(100) NOT NULL,
CONTACT_NO NUMBER(15)
);

COMMIT;


--------INSERTION OF DATA IN THE TABLES


INSERT INTO USERS(USER_ID,USER_NAME,PASSWORD,EMAIL,FIRST_NAME,LAST_NAME,COUNTRY,AGE,CHAT_MODE) VALUES (1,'TAMIM','ABCD123','tamim@gmail.com','TAMIM','IQBAL','Bangladesh',24,'ON');

INSERT INTO USERS(USER_ID,USER_NAME,PASSWORD,EMAIL,FIRST_NAME,LAST_NAME,COUNTRY,AGE,CHAT_MODE) VALUES (2,'FAISAL','STUV123','faisal@yahoo.com','FAISAL','MAHBUB','Pakistan',21,'ON');

INSERT INTO USERS(USER_ID,USER_NAME,PASSWORD,EMAIL,FIRST_NAME,LAST_NAME,COUNTRY,AGE,CHAT_MODE) VALUES (3,'ABIR','ZZZ123','hasan@gmail.com','ABIR','HASAN','Bangladesh',32,'OFF');

INSERT INTO USERS(USER_ID,USER_NAME,PASSWORD,EMAIL,FIRST_NAME,LAST_NAME,COUNTRY,AGE,CHAT_MODE) VALUES (4,'LAMIYA','77ERT','lamiya@gmail.com','LAMIYA','ZAMAN','Bhutan',29,'ON');

INSERT INTO USERS(USER_ID,USER_NAME,PASSWORD,EMAIL,FIRST_NAME,LAST_NAME,COUNTRY,AGE,CHAT_MODE) VALUES (5,'ANIKA','J2ID8','anika@gmail.com','ANIKA','KABIR','Srilanka',19,'OFF');

INSERT INTO USERS(USER_ID,USER_NAME,PASSWORD,EMAIL,FIRST_NAME,LAST_NAME,COUNTRY,AGE,CHAT_MODE) VALUES (6,'PRODHI','J2I38','prodhi@gmail.com','PARISHA','PRODHI','BANGLADESH',22,'ON');


INSERT INTO USER_GROUP(GROUP_ID,GROUP_NAME,USER_ID,CREATE_DATE,STATUS) VALUES(1,'COUSINS',2,'10-DEC-2015','ON');
INSERT INTO USER_GROUP(GROUP_ID,GROUP_NAME,USER_ID,CREATE_DATE,STATUS) VALUES(2,'COUSINS',1,'20-DEC-2014','ON');
INSERT INTO USER_GROUP(GROUP_ID,GROUP_NAME,USER_ID,CREATE_DATE,STATUS) VALUES(3,'CSE2K13',3,'13-APRIL-2016','ON');
INSERT INTO USER_GROUP(GROUP_ID,GROUP_NAME,USER_ID,CREATE_DATE,STATUS) VALUES(2,'CSE2K13',1,'13-APRIL-2016','ON');
INSERT INTO USER_GROUP(GROUP_ID,GROUP_NAME,USER_ID,CREATE_DATE,STATUS) VALUES(5,'BUDDIES',4,'13-APRIL-2016','OFF');
INSERT INTO USER_GROUP(GROUP_ID,GROUP_NAME,USER_ID,CREATE_DATE,STATUS) VALUES(6,'BUDDIES',5,'13-APRIL-2016','OFF');


INSERT INTO CONVERSATION(CONV_ID,USER_ONE,USER_TWO) VALUES (1,1,3);
INSERT INTO CONVERSATION(CONV_ID,USER_ONE,USER_GROUP) VALUES (2,2,1);
INSERT INTO CONVERSATION(CONV_ID,USER_ONE,USER_GROUP) VALUES (3,5,3);
INSERT INTO CONVERSATION(CONV_ID,USER_ONE,USER_TWO) VALUES (4,1,4);
INSERT INTO CONVERSATION(CONV_ID,USER_ONE,USER_TWO) VALUES (5,3,4);


INSERT INTO MESSAGE(MESSAGE_ID,SENDER_ID,RECEIVER_ID,MESSAGE_CONTENT,MESSAGE_CREATION_DATE) VALUES(1,1,3,'I WILL BE THERE IN A MOMENT','10-MAY-2016');
INSERT INTO MESSAGE(MESSAGE_ID,SENDER_ID,RECEIVER_GROUP_ID,MESSAGE_CONTENT,MESSAGE_CREATION_DATE) VALUES(2,2,2,'ARE THERE ANY TEST TOMORROW?','27-JUN-2016');
INSERT INTO MESSAGE(MESSAGE_ID,SENDER_ID,RECEIVER_GROUP_ID,MESSAGE_CONTENT,MESSAGE_CREATION_DATE) VALUES(3,5,2,'LET US GO FOR A PARTY!!','23-APRIL-2016');
INSERT INTO MESSAGE(MESSAGE_ID,SENDER_ID,RECEIVER_ID,MESSAGE_CONTENT,MESSAGE_CREATION_DATE) VALUES(4,1,4,'HOW ARE YOU?','10-JULY-2016');
INSERT INTO MESSAGE(MESSAGE_ID,SENDER_ID,RECEIVER_ID,MESSAGE_CONTENT,MESSAGE_CREATION_DATE) VALUES(5,3,4,'WHEN WILL YOU COME?','16-MARCH-2016');





INSERT INTO ADMIN(NAME,EMAIL,PASSWORD,CONTACT_NO) VALUES('SABRINA','sabrina.hq@gmail.com','1307005','01927366473');

COMMIT;


